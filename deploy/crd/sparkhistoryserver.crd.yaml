---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: sparkhistoryservers.spark.stackable.tech
spec:
  group: spark.stackable.tech
  names:
    categories: []
    kind: SparkHistoryServer
    plural: sparkhistoryservers
    shortNames:
    - shs
    singular: sparkhistoryserver
  scope: Namespaced
  versions:
  - additionalPrinterColumns: []
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Auto-generated derived type for SparkHistoryServerSpec via `CustomResource`
        properties:
          spec:
            properties:
              cleaner:
                nullable: true
                type: boolean
              image:
                anyOf:
                - required:
                  - custom
                  - productVersion
                - required:
                  - productVersion
                  - stackableVersion
                properties:
                  custom:
                    description: Overwrite the docker image. Specify the full docker image name, e.g. `docker.stackable.tech/stackable/superset:1.4.1-stackable2.1.0`
                    type: string
                  productVersion:
                    description: Version of the product, e.g. `1.4.1`.
                    type: string
                  pullPolicy:
                    default: IfNotPresent
                    description: '[Pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy) used when pulling the Images'
                    enum:
                    - IfNotPresent
                    - Always
                    - Never
                    type: string
                  pullSecrets:
                    description: '[Image pull secrets](https://kubernetes.io/docs/concepts/containers/images/#specifying-imagepullsecrets-on-a-pod) to pull images from a private registry'
                    items:
                      description: LocalObjectReference contains enough information to let you locate the referenced object inside the same namespace.
                      properties:
                        name:
                          description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names'
                          type: string
                      type: object
                    nullable: true
                    type: array
                  repo:
                    description: Name of the docker repo, e.g. `docker.stackable.tech/stackable`
                    nullable: true
                    type: string
                  stackableVersion:
                    description: Stackable version of the product, e.g. 2.1.0
                    type: string
                type: object
              logFileDirectory:
                oneOf:
                - required:
                  - s3
                properties:
                  s3:
                    properties:
                      bucket:
                        description: Operators are expected to define fields for this type in order to work with S3 buckets.
                        oneOf:
                        - required:
                          - inline
                        - required:
                          - reference
                        properties:
                          inline:
                            description: S3 bucket specification containing only the bucket name and an inlined or referenced connection specification.
                            properties:
                              bucketName:
                                nullable: true
                                type: string
                              connection:
                                description: Operators are expected to define fields for this type in order to work with S3 connections.
                                nullable: true
                                oneOf:
                                - required:
                                  - inline
                                - required:
                                  - reference
                                properties:
                                  inline:
                                    description: S3 connection definition as CRD.
                                    properties:
                                      accessStyle:
                                        description: Which access style to use. Defaults to virtual hosted-style as most of the data products out there. Have a look at the official documentation on <https://docs.aws.amazon.com/AmazonS3/latest/userguide/VirtualHosting.html>
                                        enum:
                                        - Path
                                        - VirtualHosted
                                        nullable: true
                                        type: string
                                      credentials:
                                        description: If the S3 uses authentication you have to specify you S3 credentials. In the most cases a SecretClass providing `accessKey` and `secretKey` is sufficient.
                                        nullable: true
                                        properties:
                                          scope:
                                            description: '[Scope](https://docs.stackable.tech/secret-operator/scope.html) of the [SecretClass](https://docs.stackable.tech/secret-operator/secretclass.html)'
                                            nullable: true
                                            properties:
                                              node:
                                                default: false
                                                type: boolean
                                              pod:
                                                default: false
                                                type: boolean
                                              services:
                                                default: []
                                                items:
                                                  type: string
                                                type: array
                                            type: object
                                          secretClass:
                                            description: '[SecretClass](https://docs.stackable.tech/secret-operator/secretclass.html) containing the LDAP bind credentials'
                                            type: string
                                        required:
                                        - secretClass
                                        type: object
                                      host:
                                        description: Hostname of the S3 server without any protocol or port
                                        nullable: true
                                        type: string
                                      port:
                                        description: Port the S3 server listens on. If not specified the products will determine the port to use.
                                        format: uint16
                                        minimum: 0.0
                                        nullable: true
                                        type: integer
                                      tls:
                                        description: If you want to use TLS when talking to S3 you can enable TLS encrypted communication with this setting.
                                        nullable: true
                                        properties:
                                          verification:
                                            description: The verification method used to verify the certificates of the server and/or the client
                                            oneOf:
                                            - required:
                                              - none
                                            - required:
                                              - server
                                            properties:
                                              none:
                                                description: Use TLS but don't verify certificates
                                                type: object
                                              server:
                                                description: Use TLS and ca certificate to verify the server
                                                properties:
                                                  caCert:
                                                    description: Ca cert to verify the server
                                                    oneOf:
                                                    - required:
                                                      - webPki
                                                    - required:
                                                      - secretClass
                                                    properties:
                                                      secretClass:
                                                        description: Name of the SecretClass which will provide the ca cert. Note that a SecretClass does not need to have a key but can also work with just a ca cert. So if you got provided with a ca cert but don't have access to the key you can still use this method.
                                                        type: string
                                                      webPki:
                                                        description: Use TLS and the ca certificates trusted by the common web browsers to verify the server. This can be useful when you e.g. use public AWS S3 or other public available services.
                                                        type: object
                                                    type: object
                                                required:
                                                - caCert
                                                type: object
                                            type: object
                                        required:
                                        - verification
                                        type: object
                                    type: object
                                  reference:
                                    type: string
                                type: object
                            type: object
                          reference:
                            type: string
                        type: object
                      prefix:
                        type: string
                    required:
                    - bucket
                    - prefix
                    type: object
                type: object
              sparkConf:
                additionalProperties:
                  type: string
                nullable: true
                type: object
            required:
            - image
            - logFileDirectory
            type: object
          status:
            nullable: true
            properties:
              phase:
                type: string
            required:
            - phase
            type: object
        required:
        - spec
        title: SparkHistoryServer
        type: object
    served: true
    storage: true
    subresources:
      status: {}
